# godo - 要件定義書

> **Git-Oriented DO** - CLIファーストのローカルTODO管理ツール

---

## 1. 概要

### 1.1 プロジェクト名

**godo** (Git-Oriented DO)

### 1.2 目的

どのディレクトリにいても統一的にTODOを管理できるCLIツールを提供する。

### 1.3 背景

- スプレッドシートでのTODO管理はWebを開く手間がかかる
- ローカルテキストファイルはファイルの場所を意識する必要がある
- Notion等のSaaSは会社未導入の場合シャドウITに該当するリスクがある
- CLIで作業する開発者にとって、ターミナルから離れずにTODO管理したいニーズがある

### 1.4 スコープ

**対象とする範囲：**

- ローカル環境でのTODO管理
- CLI経由での操作
- 設定のカスタマイズ

**対象外とする範囲（将来的に検討）：**

- GUI / TUI
- Git連携による同期
- チーム共有機能
- Web UI

---

## 2. ユーザー要件

### 2.1 ターゲットユーザー

| ペルソナ | 特徴 | ニーズ |
|---------|------|--------|
| CLI開発者 | ターミナル中心の作業スタイル | ターミナルから離れずにTODO管理 |
| セキュリティ意識の高いユーザー | SaaSにデータを置きたくない | ローカル完結のツール |

### 2.2 ユースケース

#### UC-001: タスクを追加する

- **アクター**: ユーザー
- **事前条件**: godoが初期化済み（`~/.godo/` が存在）
- **基本フロー**:
  1. ユーザーが `godo add "タスク名"` を実行する
  2. システムがタスクをファイルに保存する
  3. システムが追加完了メッセージを表示する
- **事後条件**: タスクがファイルに保存されている

#### UC-002: タスク一覧を表示する

- **アクター**: ユーザー
- **事前条件**: godoが初期化済み
- **基本フロー**:
  1. ユーザーが `godo list` を実行する
  2. システムが未完了タスクの一覧を表示する
- **代替フロー**:
  - `--all` オプション指定時は完了済みタスクも表示する

#### UC-003: タスクを完了にする

- **アクター**: ユーザー
- **事前条件**: 対象タスクが存在する
- **基本フロー**:
  1. ユーザーが `godo done <id>` を実行する
  2. システムがタスクのステータスを完了に更新する
  3. システムが完了メッセージを表示する
- **事後条件**: タスクのステータスが `done` になっている

#### UC-004: タスクを削除する

- **アクター**: ユーザー
- **事前条件**: 対象タスクが存在する
- **基本フロー**:
  1. ユーザーが `godo rm <id>` を実行する
  2. システムがタスクを削除する
  3. システムが削除完了メッセージを表示する
- **事後条件**: タスクがファイルから削除されている

#### UC-005: タスクを編集する

- **アクター**: ユーザー
- **事前条件**: 対象タスクが存在する
- **基本フロー**:
  1. ユーザーが `godo edit <id> "新しいタスク名"` を実行する
  2. システムがタスク名を更新する
  3. システムが更新完了メッセージを表示する
- **事後条件**: タスク名が更新されている

---

## 3. 機能要件

### Phase 1: MVP（v0.1.0）

| ID | 機能 | 説明 | コマンド | 優先度 |
|----|------|------|---------|--------|
| F-001 | 初期化 | 設定ファイルとデータファイルを作成 | `godo init` | Must |
| F-002 | タスク追加 | 新規タスクを追加する | `godo add "タスク名"` | Must |
| F-003 | タスク一覧 | タスク一覧を表示する | `godo list` | Must |
| F-004 | タスク完了 | タスクを完了状態にする | `godo done <id>` | Must |
| F-005 | タスク削除 | タスクを削除する | `godo rm <id>` | Must |
| F-006 | タスク編集 | タスク名を変更する | `godo edit <id> "新名"` | Should |
| F-007 | 完了済み表示 | 完了タスクも含めて表示 | `godo list --all` | Should |
| F-008 | ヘルプ表示 | 使い方を表示 | `godo --help` | Must |
| F-009 | バージョン表示 | バージョンを表示 | `godo --version` | Must |

### Phase 2: Git連携（v0.2.0）- 予定

| ID | 機能 | 説明 | 優先度 |
|----|------|------|--------|
| F-010 | Git初期化 | TODOディレクトリをGitリポジトリ化 | Should |
| F-011 | 自動コミット | 変更時に自動でcommit | Should |
| F-012 | 同期 | git pull/push のラッパー | Should |

### Phase 3: 拡張機能（v0.3.0）- 予定

| ID | 機能 | 説明 | 優先度 |
|----|------|------|--------|
| F-020 | 優先度 | タスクに優先度を設定 | Could |
| F-021 | 期限 | タスクに期限を設定 | Could |
| F-022 | タグ | タスクにタグを付与 | Could |
| F-023 | プロジェクト | プロジェクト単位での管理 | Could |
| F-024 | TUI | インタラクティブモード | Could |

---

## 4. 非機能要件

### 4.1 パフォーマンス

- タスク1000件でも一覧表示が1秒以内

### 4.2 セキュリティ

- データはローカルのみに保存（デフォルト）
- リモート同期は将来的にオプトインで提供

### 4.3 可用性

- オフライン環境で全機能が動作すること
- 外部サービスへの依存なし

### 4.4 移植性

- Linux / macOS / Windows 対応
- 単一バイナリで配布可能

### 4.5 保守性

- 設定ファイルは人間が読み書き可能な形式（TOML）
- データファイルは人間が読み書き可能な形式（Markdown）

---

## 5. データ設計

### 5.1 ディレクトリ構造

```
~/.godo/
├── config.toml    # 設定ファイル
└── tasks.md       # タスクデータ
```

### 5.2 設定ファイル（config.toml）

```toml
# godo configuration file

[general]
# タスクデータの保存先
data_file = "~/.godo/tasks.md"

[display]
# 日付フォーマット
date_format = "%Y-%m-%d %H:%M"
```

### 5.3 タスクデータ（tasks.md）

```markdown
# godo tasks

## Todo

- [ ] タスク1 <!-- id:1 created:2025-01-07T10:00:00 -->
- [ ] タスク2 <!-- id:2 created:2025-01-07T11:00:00 -->

## Done

- [x] 完了したタスク <!-- id:3 created:2025-01-06T09:00:00 done:2025-01-07T12:00:00 -->
```

### 5.4 タスクのスキーマ

| フィールド | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| id | u32 | Yes | 連番ID |
| title | String | Yes | タスク名 |
| status | Enum | Yes | `todo` / `done` |
| created_at | DateTime | Yes | 作成日時 |
| done_at | DateTime | No | 完了日時 |

---

## 6. CLI設計

### 6.1 コマンド体系

```
godo <COMMAND> [OPTIONS]

Commands:
  init          初期化（設定ファイル作成）
  add <title>   タスクを追加
  list          タスク一覧を表示
  done <id>     タスクを完了にする
  rm <id>       タスクを削除する
  edit <id>     タスクを編集する
  help          ヘルプを表示

Options:
  -h, --help     ヘルプを表示
  -V, --version  バージョンを表示
```

### 6.2 コマンド詳細

#### `godo init`

```bash
$ godo init
Created: ~/.godo/config.toml
Created: ~/.godo/tasks.md
godo initialized successfully!
```

#### `godo add <title>`

```bash
$ godo add "READMEを書く"
Added: [1] READMEを書く
```

#### `godo list`

```bash
$ godo list
  ID  Status  Task
----  ------  ----
   1  [ ]     READMEを書く
   2  [ ]     テストを書く

$ godo list --all
  ID  Status  Task
----  ------  ----
   1  [ ]     READMEを書く
   2  [ ]     テストを書く
   3  [x]     環境構築
```

#### `godo done <id>`

```bash
$ godo done 1
Done: [1] READMEを書く
```

#### `godo rm <id>`

```bash
$ godo rm 2
Removed: [2] テストを書く
```

#### `godo edit <id> <new_title>`

```bash
$ godo edit 1 "README.mdを書く"
Updated: [1] README.mdを書く
```

### 6.3 エラーハンドリング

| エラー | メッセージ例 |
|--------|-------------|
| 未初期化 | `Error: godo is not initialized. Run 'godo init' first.` |
| ID不存在 | `Error: Task #99 not found.` |
| 引数不足 | `Error: Missing argument. Usage: godo add <title>` |

---

## 7. 技術スタック

| 項目 | 選定 | 理由 |
|------|------|------|
| 言語 | Rust | 単一バイナリ、高速、クロスプラットフォーム |
| CLIフレームワーク | clap | Rustの定番、derive macroで記述が簡潔 |
| 設定ファイル形式 | TOML | Rustと相性が良い、人間が読みやすい |
| データ形式 | Markdown | 人間が読み書き可能、Git差分が見やすい |
| シリアライズ | serde | Rustの定番 |

---

## 8. 制約事項

- v0.1.0 ではGit連携機能は含まない
- v0.1.0 ではGUI/TUIは提供しない
- マルチユーザー対応は想定しない（シングルユーザー前提）

---

## 9. 用語集

| 用語 | 定義 |
|------|------|
| グローバルTODO | `~/.godo/` に保存される、どこからでもアクセス可能なTODO |
| プロジェクトTODO | 特定ディレクトリに紐づくTODO（将来実装予定） |

---

## 10. 改訂履歴

| 日付 | バージョン | 変更内容 | 担当 |
|------|-----------|---------|------|
| 2025-01-07 | 0.1.0 | 初版作成 | - |

---

## Appendix

### A. 将来の拡張案

- [ ] プロジェクト単位のTODO（カレントディレクトリに `.godo/` を作成）
- [ ] Git連携（自動commit、push/pull）
- [ ] TUI（インタラクティブモード）
- [ ] フィルタリング（タグ、優先度、期限）
- [ ] エクスポート（JSON、CSV）
- [ ] インポート（todo.txt形式）
